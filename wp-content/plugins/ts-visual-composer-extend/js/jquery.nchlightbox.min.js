!function(t,e){t.fn.mousewheel=function(n){var i,a=t(this),r=["DOMMouseScroll","mousewheel"],s="EventListener",o=function(t){return t=t||window.event,n(t,t.wheelDelta?t.wheelDelta/120:t.detail/3),t.preventDefault(),!1};a.on("mouseover mouseout",function(t){for(var n in r)t.target[t.target["add"+s]!==e?((i="mouseout"==t.type)?"remove":"add")+s:(i?"attach":"detach")+"Event"](r[n],o,!1)})}}(jQuery),function(t,e){"use strict";var n={mode:"continuous",thumbs:0,thumbsize:100,scheme:"dark",theme:"metro",size:"960,540",touch:!0,play:!0,autoplay:!1,share:!0,social:"fb,tw,gp,pin",duration:4e3,keyboard:!0,fullscreen:!0,margin:10,zoom:!0,fxspeed:400,grid:0,gridspace:4,gridorder:!0,captions:"title",info:!1,backlight:"#FFF",animation:"swipe",cors:!1,hashpath:"nch/",bgclose:!1},i=[],a={title:!1,type:!1,rel:!1,src:!1,href:!1,width:0,height:0,color:!1,effect:!1},r={},s={light:!1,current:!1,scrollbar:!0,all:{},phase:!0,css3:window.nchcss3,ns:t({}),event:{trigger:function(){s.ns.trigger.apply(s.ns,arguments)},on:function(){s.ns.on.apply(s.ns,arguments)},off:function(){s.ns.off.apply(s.ns,arguments)}},canFS:!1},o={},c={open:function(t){t.group.main.fadeIn(300)},close:function(t){var e;t.main.fadeOut(300),d.pause(!1);for(var n in t.set)(e=t.set[n].thumb)&&(e.className="")},slideOut:function(t,n){var i=d.getFX(t.opts.effect,t),a=t.group,r=a.css3,o=a.blocks.preview,c=s.phase?-1:1,h=i(0,0,0,1)!==e,l=function(t){return(h?i(0,0,0,t):t)+s.wsize};i(r,c,!0),o.stop().animate({scrollLeft:l(-c*s.wsize)},{duration:500,complete:function(){a.blocks.media.css("visibility","hidden"),i(r,0),n()}}),t.thumb!==e&&(t.thumb.className="")},slideIn:function(t,n){n=n===e?function(){}:n;var i=d.getFX(t.opts.effect,t),a=t.group,r=a.css3,o=a.blocks.preview,c=s.phase?1:-1,h=i(0,0,0,1)!==e,l=function(t){return(h?i(0,0,0,t):t)+s.wsize};i(r,c),a.blocks.media.css("visibility","visible"),r.el.offsetHeight+1,i(r,0,!0),a.blocks.media.css("visibility","visible"),o.stop().scrollLeft(l(-c*s.wsize)).animate({scrollLeft:l(0)},500,function(){o.scrollLeft(l(0))})}},h={youtube:{is:function(t){var e=t.opts.href.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/);return e?(t.opts.size||(t.opts.size=t.group.opts.size),t.opts.videoid=e[1],!0):!1},create:function(t){return'<iframe class="nch-lb-iframe nch-video-youtube" src="http://www.youtube.com/embed/'+t.opts.videoid+'?wmode=opaque" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowfullscreen></iframe>'},thumb:function(t,e){d.loadThumb.call(t,t.opts.src="http://img.youtube.com/vi/"+t.opts.videoid+"/hqdefault.jpg",e)}},vimeo:{is:function(t){var e=t.opts.href.match(/(http|https):\/\/(?:www.)?(?:(vimeo).com)\/(.*)/);return e?(t.opts.videoid=e[3],t.opts.size||(t.opts.size=t.group.opts.size),!0):!1},create:function(t){return'<iframe class="nch-lb-iframe nch-video-vimeo" src="http://player.vimeo.com/video/'+t.opts.videoid+'" width="500" height="500" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},thumb:function(e,n){t.getJSON("http://vimeo.com/api/v2/video/"+e.opts.videoid+".json?callback=?",{format:"json"},function(t){d.loadThumb.call(e,e.opts.src=t[0].thumbnail_large,n)})}},dailymotion:{is:function(t){console.log(t);var e=t.opts.href.match(/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/);return null!==e?void 0!==e[4]?(t.opts.videoid=e[4],!0):(t.opts.videoid=e[2],!0):!1},create:function(t){return'<iframe class="nch-lb-iframe nch-video-dailymotion" src="http://www.dailymotion.com/embed/video/'+t.opts.videoid+'" width="500" height="500" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},thumb:function(t,e){d.loadThumb.call(t,t.opts.src="http://www.dailymotion.com/thumbnail/video/"+t.opts.videoid,e)}},html:{is:function(t){return t.opts.href=t.opts.href.replace(window.location,""),"#"==t.opts.href.charAt(0)||"."==t.opts.href.charAt(0)},create:function(e){return t(e.opts.href).show().get(0)}},ajax:{is:function(t){return t.opts.href.search(/^https?:\/\//i)<0},create:function(e,n){t.ajax({url:e.opts.href,success:n})}},iframe:{is:function(){return!0},create:function(t){return'<iframe class="nch-lb-iframe" src="'+t.opts.href+'" frameBorder="0"></iframe>'}}},l={init:function(i){var r=arguments,o=t(this);if(0==o.length){if(i===e)return o;i.length===e&&1==r.length?t.extend(n,i):(o=d.setFrom.apply(this,[i.charAt!==e?[i]:i,r[1]||{}]),(r[1]||{}).open===e&&l.open.call(o))}else i=i||{},o.each(function(n,r){var o,c=t(r),h=c.is("img")?c:t("img",c);if(o=t.extend({},a,d.getDataProperties(c,{rel:"rel",title:"title",href:"href"})),h.length>0&&(o.src=h.attr("src")),(c.is("a")||0==h.length)&&(h=c),o.rel)s.all[o.rel]===e&&(s.all[o.rel]=new d.mediaGroup(i,o.rel)),s.all[o.rel].add(h,o);else{var l=new d.mediaGroup(i);l.add(h,o),s.all[l.name]=l}});for(var c in s.all)d.renderGrid(s.all[c]);return o},open:function(i){var a,r=t(this);if(i!==e&&s.all[i]!==e&&(a=s.all[i].set[0]),r.data("nch-lb-media")!==e)a=r.data("nch-lb-media");else if(this.jquery)return l.init.apply(this,arguments),l.open.call(this);a&&(s.event.trigger("open",a.group),window.location.hash="#"+n.hashpath+a.opts.hash),s.scrollpos=s.w.scrollTop(),s.doc.addClass("nch-lb-noscroll")},next:function(t){if(s.current){var i=s.current,a=i.set.length,r=i.current,o=i.set[r+1==a?0:r+1];window.location.hash="#"+n.hashpath+o.opts.hash,d.pause(t===e),s.phase=!0,s.event.trigger("next",[s.current,o])}},previous:function(){if(s.current){var t=s.current,e=t.set.length,i=t.current,a=t.set[0==i?e-1:i-1];window.location.hash="#"+n.hashpath+a.opts.hash,d.pause(!1),s.phase=!1,s.event.trigger("previous",[s.current,a])}},close:function(){if(s.current){var t=s.current;window.location.hash="",history&&history.pushState&&history.pushState("",document.title,window.location.pathname+window.location.search),t.playing&&l.play(),d.fs.on&&d.fs.toggle(),d.detachMedia(t.set[t.current]),s.event.trigger("close",t),c.close(t),s.current.paused=!1,s.current=t.current=!1,s.doc.removeClass("nch-lb-noscroll"),s.w.scrollTop(s.scrollpos)}},fx:function(n,i){i===e?t.extend(o,n):o[n]=i},access:function(t,n){return t!==e&&(d[t]=n),d},play:function(t){var n=s.current,i=n.opts,a=n.main,r=n.blocks.loading,o=n.playing,c=i.duration;if(i.play)return t===e&&o?o:(a.toggleClass("nch-lb-playing"),o?r.stop():r.animate({width:a.width()},{easing:"linear",duration:(1-r.width()/a.width())*c,complete:function(){n.paused=!0,l.next()}}),t!==!1&&s.event.trigger(o?"stop":"play",n),n.playing=!o)},stop:function(){return s.current.playing&&l.play(!0),!1},info:function(){return s.current?d.toggleInfo.apply({},arguments):void 0},addEvent:function(t,e){s.event.on(t,e)},removeEvent:function(t,e){s.event.off(t,e)},getGroupName:function(){var n,i=t(this),a=!1;return i.length>0?(n=t(i.get(0)).data("nch-lb-media"))!==e?n.group.name:a:a},getMediaId:function(){var n,i=t(this),a=!1;return i.length>0?(n=t(i.get(0)).data("nch-lb-media"))!==e?n.opts.hash:a:a}},u="",d={toggleInfo:function(t){var n=s.current,i=n.blocks,a=i.info.children(".nch-lb-info-panel");return t!==e&&n.about==t?t:(i.info["fade"+(n.about?"Out":"In")](400),a.append(n.info.show()),s.event.trigger((n.about?"close":"open")+"_info",[n]),n.about=!n.about)},selectThumb:function(n){var i,a=n.thumb,r=n.group,s=r.blocks,o=0,c=t(a),h=c.parent(),l=h.prev().find("img").get(0),u=h.next().find("img").get(0);if(a!==e&&r.opts.thumbs){for(var d in r.set)(i=r.set[d].thumb)&&(i.className="");var p,f,g,m=(a.className="nch-lb-thumb-s",r.opts),v={top:1,bottom:1,left:0,right:0}[m.thumbs],b=s.bthumbs,w=(s.thumbs,b[v?"width":"height"]()),y=v?"left":"top",x="offset"+(v?"Width":"Height"),k={};o=b[f="scroll"+y.substr(0,1).toUpperCase()+y.substr(1)](),g=c.position()[y];var j=g-4,Q=g+(p=a[x])+4;l!==e&&(j-=l[x]+4),u!==e&&(Q+=u[x]+4),Q-j>w?k[f]=g+a[x]/2-w/2:o>j?k[f]=j:Q-w>o&&(k[f]=Q-w),b.animate(k,200)}},scrollThumbs:function(t,e){var n,i=s.current,a=i.opts,r=a.thumbs,o={left:"Top",top:"Left",right:"Top",bottom:"Left"};i&&r&&(n=i.blocks.bthumbs,n["scroll"+o[r]](n["scroll"+o[r]]()+120*e))},useTouch:function(i){var a;i.hammer({prevent_default:!0}).on("dragstart",function(r){function o(t){return(p=t.gesture)?(f=p.deltaX,((g=Math.abs(f))>25||m)&&(m=!0,i.stop().scrollLeft(k(-f)),y(w,f/s.wsize)),void 0):!1}function c(){var t=s.current.set.length,e=s.current.current;g>v&&t>1&&("linear"==s.current.opts.mode?!(0==e&&f/g>0||e==t-1&&0>f/g):1)?(h=f>0?0:2*s.wsize,i.animate({scrollLeft:k(h-s.wsize)},n.fxspeed,function(){l[0>f/g?"next":"previous"](!0)}),y(w,f/g,!0)):(i.stop().animate({scrollLeft:k(0)},n.fxspeed),y(w,0,!0)),i.off("drag",o).off("dragend",c)}if(r.gesture===e)return!1;if(a===e&&(a=!(r.gesture.srcEvent.changedTouches===e))&&s.b.addClass("nch-lb-photo-menu-visible"),s.zooming||!s.current||r.gesture===e)return!0;var h,u,p,f,g,m=(t(r.target),r.timeStamp,!1),v=s.wsize/3,b=s.current,w=b.css3,y=d.getFX(b.set[b.current].opts.effect,b.set[b.current]),x=y(0,0,0,1)!==e,k=function(t){return(x?y(0,0,0,t):t)+s.wsize};return u=r.gesture,i.on("drag",o).on("dragend",c),!1})},pause:function(t){s.current.playing&&!s.current.paused&&((t===!0||"mouseover"==t.type)&&(s.current.paused=!0),l.play(!1))},resume:function(){!s.current.playing&&s.current.paused&&(l.play(!1),s.current.paused=!1)},openShare:function(e){if(s.current){var n,i=s.current,a=i.current,r=i.set[a];"nch-lb-icon-share"==e.target.className?r.share&&"block"==r.share.css("display")?(r.share.hide(),i.main.removeClass("nch-lb-sharing")):(i.main.addClass("nch-lb-sharing"),r.share||(r.share=n=t('<div class="nch-lb-share-btns"></div>').appendTo(t("li.nch-lb-share",i.blocks.menu)),d.shareButtons(n,i.opts.social,d.getMediaProperties(r))),r.share.show()):r.share&&(r.share.hide(),i.main.removeClass("nch-lb-sharing"))}},renderGrid:function(n){var i,a,r,s,o=n.opts,c=n.set,h=!1,u=[];if(o.grid&&!n.hasGrid){n.hasGrid=!0,i=o.grid.split(",");for(var p in i)i[p]=parseInt(i[p]);d.need(n.set,d.getThumbnail,function(){for(var n in c)c[n].thumb!==e&&(a=c[n].main.hide(),h||(h=a),r=t(c[n].thumb).clone(!0).data("nch-lb-media",c[n]).click(l.open).get(0),r.title=c[n].opts.title?c[n].opts.title:"",u.push(r));t('<div class="nch-lb-grid"></div>').insertAfter(h).append(s=t(u)),s.nchgrid({grid:i,margin:o.gridspace,order:o.gridorder,captions:o.captions})})}},parseColor:function(t){for(var e,n=(t+"").split(/bg|\_|\-|\.|\&|\#/),i=0;i<n.length;i++)if((6==(e=n[i].length)||3==e)&&new RegExp("[a-f0-9]{"+e+"}").test(n[i]))return"#"+n[i];return!1},toggleZoom:function(){var e=s.current,n=e.main,i="nch-lb-zooming",a=e.set[e.current];if(a.nsize,n.hasClass(i))s.zooming=!1,d.updateMediaLayout(a),e.blocks.zoom.find(".nch-lb-zoom-container").remove();else{s.zooming=!0;var r,o=new Image;o.onload=function(){r=d.pinch.call(t(o),"100%","100%").css({position:"absolute"}).addClass("nch-lb-zoom-container"),e.blocks.zoom.append(r)},o.src=a.target.src}n.toggleClass(i)},getMediaProperties:function(t){var e=t.opts,n=e.type,i={title:e.title||document.title,media:"html"!=n&&"ajax"!=n?"image"==n||"iframe"==n?t.target.src:e.href:""};return i.url="youtube"==n||"vimeo"==n||"dailymotion"==n||"iframe"==n?i.media:window.location.href,i},detachMedia:function(e){var n=e.group,i=n.main;t(".nch-lb-title",i).each(function(){t(this).html("")}),t(e.target).detach()},getInnerHeight:function(t,e){t.css({width:e,height:"auto"});var n=t.height();return t.css({height:"auto"}),n},getInnerWidth:function(t,e){t.css({height:e,width:1});var n=t[0].scrollWidth;return t.css({width:"auto"}),n},renderMedia:function(e){function n(n){e.html=n,e.target=t(n)[0],i()}function i(){p.attr("class","nch-lb-media").addClass("nch-lb-media-"+f.type).append(e.target),o.paused&&(l.play(!1),l.play(!1),o.paused=!1),d.updateMediaLayout(e)}var a,r,o=s.current,c=o.main,u=o.blocks,p=u.media,f=e.opts,g=f.type;t(".nch-lb-title",c).each(function(){t(this).html(f.title)}),u.loading.width(0),e.target?i():"youtube"==g||"vimeo"==g||"dailymotion"==g?(e.target=a=t(h[g].create(e)).get(0),r=function(){i(),this.onload&&(this.onload=function(){})},a.attachEvent?a.attachEvent("onload",r):a.onload=r,s.root.append(a)):"iframe"==g?(e.target=a=t(h[g].create(e)).get(0),i()):("html"==g||"ajax"==g)&&("html"==g?n(h[g].create(e)):h[g].create(e,n))},fitInto:function(t,e,n,i){var a,r,s=t/e,o=n/i;return s>o?(a=n>t?t:n,r=a/s):(r=i>e?e:i,a=r*s),[a,r]},updateMediaLayout:function(e){var n,i,a,r,o=!1,c=s.current,h=c.blocks,l=(h.preview,h.media),u=c.mspace.width,p=c.mspace.height,f=e.opts,g=f.type,m={top:0,left:0,width:0,height:0},v=e.nsize;if(s.zooming)return!0;if(("youtube"==g||"vimeo"==g||"dailymotion"==g)&&(v=e.nsize=e.group.opts.size.split(",")),r=isNaN(f.width)||isNaN(f.height),"image"==g||"youtube"==g||"vimeo"==g||"dailymotion"==g){var b=v[0]/v[1];0==f.width&&0==f.height?(a=d.fitInto(v[0],v[1],u,p),m.width=a[0],m.height=a[1]):0==f.height?(m.width=u<f.width?u:f.width,m.height=m.width/b>p?(m.width=p*b)/b:m.width/b):0==f.width?(m.height=p<f.height?p:f.height,m.width=m.height*b>u?(m.height=u/b)*b:m.height*b):r||(a=d.fitInto(f.width/1,f.height/1,u,p),m.width=a[0],m.height=a[1])}else"iframe"==g?(0==f.width?m.width=u:r||(m.width=f.width>u?u:f.width),0==f.height?m.height=p:r||(m.height=f.height>p?p:f.height)):("html"==g||"ajax"==g)&&e.target&&(o=!0,f.width>0&&(m.width=f.width>u?u:f.width),f.height>0&&(m.height=f.height>p?p:f.height));if(r&&(f.width/1?m.width=f.width/1:f.height/1&&(m.height=f.height/1),n=isNaN(f.width)?parseFloat(f.width)/100*u:0,i=isNaN(f.height)?parseFloat(f.height)/100*p:0,i&&n?(i||(i=n/v[0]*v[1]),n||(n=i*v[0]/v[1]),a=d.fitInto(n,i,u,p),m.width=a[0],m.height=a[1]):i?n=m.width?m.width:i*v[0]/v[1]:n&&(i=m.height?m.height:n/v[0]*v[1]),a=d.fitInto(n,i,u,p),m.width=a[0],m.height=a[1]),o){m.width||m.height||(m.width=Math.min(u,p));var w=t('<div style="display:block;position:relative;padding:1px"></div>').append(t(e.target).clone()).appendTo(s.root);m.width||(m.width=Math.min(d.getInnerWidth(w,m.height),u)),m.height||(m.height=Math.min(d.getInnerHeight(w,m.width),p)),w.remove()}if(m.top=s.mposy=(p-m.height)/2,m.left=s.wsize+c.mspace.left+(u-m.width)/2,e.group.main[("image"==g&&(v[0]>m.width||v[1]>m.height)&&c.opts.zoom?"add":"remove")+"Class"]("nch-lb-can-zoom"),l.css(m),"iframe"==g||"youtube"==g||"vimeo"==g||"dailymotion"==g){var y=t("iframe.nch-lb-iframe",l);isNaN(m.height)?y.height("100%"):y.height(m.height),isNaN(m.width)?y.width("100%"):y.width(m.width)}},getMediaColor:function(t,e){var i=t.opts;return i.color?e(i.color):("image"==i.type&&s.hasCanvas?d.getMainColor(t.target,function(t){e("rgb("+t.join(",")+")")}):e(n.backlight),void 0)},enoughThumbs:function(t){for(var e=0,n=0;n<t.set.length;n++)t.set[n].opts.src&&e++;return e>1?!0:(t.opts.thumbs=!1,!1)},toMedia:function(t){function e(){t.group.main&&t.group.blocks.media.css({width:0,height:0}),0==t.group.main&&(d.renderLayout(t.group),d.selectThumb(t)),s.current!==t.group?(s.current&&c.close(s.current.group),s.current=t.group,s.current.current=t.index,c.open(t)):r=t.group.current,d.updateLayout(),a===!1?a=!0:a!==!0&&a()}function n(e){t.opts.type=e,d.renderMedia(t),d.updateMediaLayout(t),c.slideIn(t,function(){}),d.getMediaColor(t,function(e){function n(){d.light(t.opts.color)}t.opts.color=e,s.light===!1?s.event.on("maskload",n):n()}),s.current.current=t.index}var i,a=!1,r=!1;l.open.call(t),d.enoughThumbs(t.group),s.current&&s.current==t.group&&(r=s.current.current)!==!1&&(s.phase=r&&t.index||r+t.index!=t.group.set.length-1?r<t.index:r>t.index),t.group.main&&d.selectThumb(t),s.zooming&&d.toggleZoom(),s.current?c.slideOut(i=s.current.set[s.current.current],function(){d.detachMedia(i),e()}):e(),d.getMediaType(t,function(t){var e=function(){n(t)};a===!0?e():a=e})},renderLayout:function(e){var n,i=e.main=t('<div class="nch-lb-main"></div>').appendTo(s.b),a=e.opts,r="",o={};o.loadicon=t('<div class="nch-lb-media-loading"></div>').appendTo(i),s.canFS&&a.fullscreen&&(r+="nch-lb-can-fs "),a.share&&(r+="nch-lb-can-share "),a.play&&e.set.length>1&&(r+="nch-lb-can-play "),a.zoom&&(r+="nch-lb-can-zoom "),a.info&&(r+="nch-lb-has-info "),s.scrollbar||(r+="nch-lb-no-scrollbar "),i.addClass(r);var c={v:"vertical",h:"horizontal"},h={left:"v",right:"v",top:"h",bottom:"h"},u={v:"width",h:"height"};if(s.asb){var p=o.asb=t('<div class="nch-lb-pngfix"></div>').appendTo(i);d.css3(p).transition("background-color 500ms linear")}a.info&&(e.info=(n=t("#"+a.info)).length?n:t("<div></div>"));var f,g=o.tbar=t('<div class="nch-lb-tbar"></div>').appendTo(i),m=t('<ul class="nch-lb-tbar-controls"></ul>'),v=o.bbar=t('<div class="nch-lb-bar"></div>').appendTo(i),b=o.controls=t('<ul class="nch-lb-controls"></ul>').appendTo(v),w={prev:"left",play:"play",next:"right",title:!1,exit:"exit",fs:"fs",info:"info"};1==e.set.length&&i.addClass("nch-lb-no-more");for(var y in w)b.append(f='<li class="nch-lb-'+y+'">'+(w[y]?'<div class="nch-lb-icon-'+w[y]+'"></div>':"")+"</li>"),("exit"==y||"title"==y||"info"==y||"fs"==y)&&m.append(f);if(a.thumbs){var x=o.thumbs=t('<ul class="nch-lb-thumbs"></ul>'),k=o.bthumbs=t('<div class="nch-lb-thumbs-bar"></div>').append(x);if(k.addClass("nch-lb-thumbs-"+a.thumbs).css(a.thumbs,0),x.addClass("nch-lb-thumbs-"+c[h[a.thumbs]]).css(u[h[a.thumbs]],a.thumbsize),"bottom"==a.thumbs?v.append(k):"top"==a.thumbs?g.append(k):i.append(k),"v"==h[a.thumbs]){var j={left:"auto",right:"auto"};j["left"==a.thumbs?"right":"left"]=k[u[h[a.thumbs]]](),g.css(j),v.css(j)}}m.appendTo(g);var Q,C=o.preview=t('<div class="nch-lb-media-space"></div>').appendTo(i);o.scroller=t('<div class="nch-lb-media-scroller"></div>').appendTo(C).append(Q=o.media=t('<div class="nch-lb-media"></div>')),e.css3=d.css3(Q);for(var z=o.menu=t('<ul class="nch-lb-photo-menu"></ul>').appendTo(Q),I=["zoom","share"],y=0;y<I.length;y++)z.append('<li class="nch-lb-'+I[y]+'"><div class="nch-lb-icon-'+I[y]+'"></li>');o.info=t('<div class="nch-lb-project"><div class="nch-lb-info-panel"><div class="nch-lb-icon-close"></div></div></div>').appendTo(i),o.loading=t('<div class="nch-lb-loadbar"></div>').appendTo(i),Q.on("mouseover",d.pause).on("mouseout",d.resume),e.blocks=o,a.thumbs&&d.need(e.set,d.getThumbnail,function(){d.renderThumbnails(e)}),o.zoom=t('<div class="nch-lb-zoom-space"><div class="nch-lb-icon-zoom"></div></div>').appendTo(i),a.autoplay&&(e.playing=!0,e.paused=!0,i.addClass("nch-lb-playing")),t("div.nch-lb-icon-fs",i).each(function(){t(this).click(d.fs.toggle)}),t("li.nch-lb-exit",i).each(function(){t(this).click(l.close)}),t("li.nch-lb-prev",b).click(l.previous),t("li.nch-lb-next",b).click(l.next),t("li.nch-lb-play",b).click(l.play),t("div.nch-lb-icon-info",i).each(function(){t(this).click(d.toggleInfo)}),t("div.nch-lb-icon-close",i).each(function(){t(this).click(d.toggleInfo)}),t("div.nch-lb-icon-zoom",i).hammer().on("tap",d.toggleZoom),i.hammer().on("tap",d.openShare),a.touch&&d.useTouch(o.preview),a.bgclose&&d.backgroundClose(o)},backgroundClose:function(t){t.preview.click(function(t){t.target.className.search("nch-lb-media-space")>=0&&l.close()})},fs:{on:!1,request:function(t){return d.fs.on=!0,t.requestFullScreen?t.requestFullScreen():t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?1==t.webkitRequestFullScreen.length?t.webkitRequestFullScreen():t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):t.mozRequestFullScreen?t.mozRequestFullScreen():d.fs.on=!1},has:function(){var t=d.fs.request(document.documentElement);return 0!=t},exit:function(){var t=document;t.cancelFullScreen?t.cancelFullScreen():t.exitFullscreen?t.exitFullscreen():t.webkitCancelFullScreen?t.webkitCancelFullScreen():t.mozCancelFullScreen&&t.mozCancelFullScreen(),d.fs.on=!1},toggle:function(){var t="nch-lb-onfs",e=s.current.main;d.fs.on?(e.removeClass(t),d.fs.exit()):(e.addClass(t),d.fs.request(document.documentElement))}},loadThumb:function(t,e){var n;this.thumb=n=new Image,n.onload=e,n.src=t},updateLayout:function(n){function i(){s.asb||p.append(s.light[0].$el.height(f[2]+100),s.light[1].$el.height(f[2]+100))}var a=s.current,r=s.wsize=s.w.width(),o=s.hsize=s.w.height();if(a){var c,h=a.blocks,l=h.preview,u=a.opts,p=u.margin,f=[p,p,p,p],p=a.main,g=h.bthumbs,m={top:0,right:1,bottom:2,left:3},v="height",b="width",w=[v,b,v,b];g!==e&&"bottom"!=u.thumbs&&"top"!=u.thumbs&&(f[m[u.thumbs]]+=g[w[m[u.thumbs]]]()),f[0]+=h.tbar.height(),f[2]+=h.bbar.height(),c={top:f[0],left:f[3],width:r-f[1]-f[3],height:o-f[0]-f[2]},h.bbar.width(c.width+2*u.margin),h.tbar.width(c.width+2*u.margin),l.css(t.extend({},c,{left:0,width:r,height:c.height+40})),h.loadicon.css({left:c.left+c.width/2,top:c.top+c.height/2}),a.mspace=c,s.hasCanvas&&(s.light?i():s.event.on("maskload",i)),0!=a.set[a.current].opts.type&&a.set[a.current].target&&d.updateMediaLayout(a.set[a.current]),n!==e&&l.scrollLeft(s.wsize)}},light:function(t,e){if(s.hasCanvas){if(s.asb&&s.current){var n=s.current.blocks.asb.get(0);return n.style.backgroundColor=t,void 0}var i=arguments,a={opacity:1,display:"block"},r={opacity:0},o=s.light[0],c=s.light[1];2==i.length?t.main.append(o.$el,c.canvas):e=t;var t=[0,0,c.width,c.height];c.$el.stop().animate(r,500,function(){d.toColor(c,e),c.$el.css(a),o.$el.hide()}),d.toColor(o,e),o.$el.stop().show().css(r).animate(a,500)}},toColor:function(t,e){var n=t.width,i=t.height,a=t.context;a.clearRect(0,0,n,i),a.fillStyle=e,a.fillRect(0,0,n,i),t.mask()},masks:function(){var e=this,n=(t("div.nch-lb-mask"),t('<canvas class="nch-lb-effcurrent"></canvas>')),i=t('<canvas class="nch-lb-effchange"></canvas>');s.color="#000",s.light=s.asb?[]:[new d.canvasMask(n,e),new d.canvasMask(i,e)],s.event.trigger("maskload")},getImageURL:function(t){var e=/^url\((['"]?)(.*)\1\)$/.exec(t.css("background-image"));return e?e[2]:""},hashChange:function(){var t="";window.setInterval(function(){t!=window.location.hash&&0==(t=window.location.hash).search("#"+n.hashpath)&&d.route(t.replace("#",""))},150)},route:function(t){if(r[t]!==e){var n=r[t];d.toMedia(n.call!=e?n():n)}},addRoute:function(t,e){r["nch_"+t]=e},isImage:function(t,i,a){var r=new Image,s=function(){i("image")};r.onerror=a||function(){d.getMediaType(t,i,!0)},r.onload=function(){t.target=this,t.nsize=[this.width,this.height],a===e&&!d.allowedOrigin(this)&&n.cors?d.isImage(t,i,s):i("image")},a!==e&&(r.crossOrigin="anonymous"),r.src=t.opts.href},getMediaType:function(t,n,i){var a=t.opts;if(0!=a.type)return t.target||("youtube"==a.type||"vimeo"==a.type||"dailymotion"==a.type)&&a.videoid===e&&h[a.type].is(t),n(a.type);if(i){for(var i in h)if(h[i].is(t))return n(i)}else d.isImage.apply(this,arguments)},need:function(t,e,n){for(var i=t.length-1,a=0,r=function(){a++==i&&n()},s=0;i>=s;s++)e(t[s],r)},getThumbnail:function(t,n){var i=new Image,a=t.opts,r=a.type,s=function(){n(t)};return t.thumb!==e?n(t):(a.src?(i.onload=s,i.src=a.src,t.thumb=i):"youtube"==r||"vimeo"==r||"dailymotion"==r?(t.opts.videoid===e&&h[r].is(t),h[r].thumb(t,s)):n(t),void 0)},renderThumbnails:function(n){var i,a,r=(n.main,n.opts),s=n.blocks,o=s.thumbs.empty(),c=0,h={bottom:1,top:1,left:0,right:0};o[h[n.opts.thumbs]?"height":"width"](n.opts.thumbsize),window.setTimeout(function(){for(var s in n.set)(i=n.set[s].thumb)!==e&&(a=(i.naturalWidth||i.width)/(i.naturalHeight||i.height),c+=r.thumbsize*(h[n.opts.thumbs]?a:1/a)+8,o.append(t("<li></li>").append(t(n.set[s].thumb).removeAttr("width","height").data("nch-lb-media",n.set[s]).click(l.open))));o[h[n.opts.thumbs]?"width":"height"](c-6)},25),o.hammer({prevent_default:!1}).on("drag",function(){return!0}),o.mousewheel(d.scrollThumbs)},getFX:function(t,e){if(t===!1&&(e.opts.effect=t=e.group.opts.animation),"random"==t){var n=[];for(var i in o)n.push(i);e.opts.effect=e.opts.animation=t=n[Math.round(Math.random()*(n.length-1))]}return o[t]||function(){}},mediaGroup:function(e,i){var a,s,o,c=this;i||(i=d.randomName()),this.main=!1,this.name=a=i,this.opts=s=t.extend({},n,e),this.current=!1,this.set=[],this.playing=!1,this.paused=!1,this.about=!1,this.add=function(t,e){var i=new d.mediaItem(t,d.inheritProps(s,e));i.group=c,i.opts.rel=a,i.index=c.set.length,i.opts.href||(i.opts.href=i.opts.src),(o=d.parseColor(i.opts.href+i.opts.src))&&(i.opts.color=o),r[n.hashpath+i.opts.hash]=i,c.set.push(i)}},allowedOrigin:function(e){if(!s.hasCanvas)return!0;var n=s.tcanvas,i=n.getContext("2d"),a=n.width,r=n.height;i.clearRect(0,0,a,r),i.drawImage(e,0,0);try{i.getImageData(0,0,1,1)}catch(o){return t(s.tcanvas).remove(),t(s.tcanvas=document.createElement("canvas")).addClass("nch-lb-testcanvas").appendTo(s.b),!1}return!0},inheritProps:function(t,n){for(var i in t)n[i]!==e&&(t[i]=n[i]);return n},mediaItem:function(e,n){var i;this.main=e,this.opts=i=t.extend({hash:d.getHash(n)},a,n),this.target=!1,this.share=!1,e.data("nch-lb-media",this),e.click(function(t){return t.preventDefault(),l.open.call(this),!1})},keyboard:function(t){var e=t.which,n=s.current;n&&n.opts.keyboard&&(32==e&&n.opts.play&&l.play(),37==e&&l.previous(!0),39==e&&l.next(!0),27==e&&l.close())},setFrom:function(n,i){var a,r=t(),o=new d.mediaGroup(i);for(var c in n)n[c].charAt!==e&&(n[c]={href:n[c]}),a=t('<a href="'+n[c].href+'"></a>'),n[c].src&&a.append('<img src="'+n[c].src+'">'),o.add(a,n[c]),r=r.add(a);return s.all[o.name]=o,r},randomName:function(){return"nch_group_"+Math.round(Math.random()*(new Date).getTime())},getHash:function(t){var a,s,o=t.href?t.href:t.href=t.src,c=0;if(t.hash?1:0,o===e||0==(o+"").length)return c;for(a=0;a<o.length;a++)s=o.charCodeAt(a),c=(c<<5)-c+s,c&=c;if(c=Math.abs(c),r[n.hashpath+c]!==e)for(;r[n.hashpath+c]!==e;)c++;return i.push(c),c},getDataProperties:function(e){e.jquery&&(e=e.get(0));for(var n,i=arguments,a=i[1]?i[1]:[],r={},s=0;s<e.attributes.length;s++){var o=e.attributes[s].name;(a[o]||t.inArray(o,a)>=0||0==o.search("data-"))&&(r[a[o]?a[o]:o.replace("data-","")]=(n=e.getAttribute(o))==parseInt(n)?parseInt(n):n)}return r},canvasMask:function(t,e){if(s.hasCanvas){var n,i,a;this.$el=t,this.canvas=t=t.get(0),this.context=n=t.getContext("2d"),this.mask=e,this.width=i=t.width=e.width,this.height=a=t.height=e.height,n.drawImage(e,0,0),this.maskdata=function(t){for(var e=[],n=0,r=0;a>r;r++)for(var s=0;i>s;s++,n+=4)e.push(t.data[n]);return e}(n.getImageData(0,0,i,a)),n.clearRect(0,0,i,a),this.mask=function(){for(var t=this.maskdata,e=4*t.length,r=0,s=n.getImageData(0,0,i,a);e>r;)s.data[r+3]*=t[r/4]/255,r+=4;n.putImageData(s,0,0)}}},hexToRGB:function(t){var e=t.replace("#",""),n=e.match(/.{1,1}/g);e.length/3<2&&(e=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),e=e.match(/.{1,2}/g);for(var i=0;3>i;i++)e[i]=parseInt(e[i],16);return e},drawImageOnto:function(t,e,n,i,a,r,s){var o=this,c=arguments;try{t.drawImage(e,n,i,a,r)}catch(h){return window.setTimeout(function(){d.drawImageOnto.apply(o,c)},0),void 0}s()},getMainColor:function(t,e){var n,i,a,r=document.createElement("canvas"),o=r.getContext("2d"),c=0,h=0,l=r.width=200,u=r.height=200,p=[0,0,0],f=d.hexToRGB(s.current.opts.backlight);return r.getContext&&o?(d.drawImageOnto(o,t,0,0,200,200,function(){try{n=o.getImageData(0,0,l,u)}catch(t){return e(f)}for(var r=0;u>r;r++)for(var s=0;l>s;s++)i=(n.data[c]+n.data[c+1]+n.data[c+2])/3,a=Math.abs(i-n.data[c])+Math.abs(i-n.data[c+1])+Math.abs(i-n.data[c+1]),a>h&&(h=a,p=[n.data[c],n.data[c+1],n.data[c+2]]),c+=4;e(p)}),void 0):e(f)}};t.fn.nchlightbox=function(t){return l[t]?l[t].apply(this,Array.prototype.slice.call(arguments,1)):l.init.apply(this,arguments)},t.fn.nchlightbox.defaults=n,t(document).ready(function(){t(".nch-hide-if-javascript").hide(),s.b=t("body"),s.w=t(window).resize(d.updateLayout),s.doc=t(document.documentElement),d.hashChange();var n;s.asb=(n=navigator.userAgent.toLowerCase()).search("android")>0&&n.search("mobile safari")>0&&n.search("linux")>0&&n.search("chrome")<0;var i=document.createElement("canvas"),a=s.root=t('<div class="nch-lb-mask"></div>').appendTo(s.b);(s.hasCanvas=!(!i.getContext||!i.getContext("2d")))?(u=new Image,u.onload=d.masks,u.src=d.getImageURL(a),t(s.tcanvas=document.createElement("canvas")).addClass("nch-lb-testcanvas").appendTo(s.b)):d.masks(),s.canFS=d.fs.has(),d.fs.on=!1,s.w.keyup(d.keyboard);var r=t('<div class="nch-lb-scrollbars"></div>').appendTo(s.b),o=r.get(0).clientWidth,c=r.get(0).offsetWidth;o!==e&&c!==e&&c==o&&(s.scrollbar=!1),r.remove(),t(".nch-lightbox").nchlightbox()})}(jQuery),function(t,e,n,i){function a(t){for(var e=t.split("-"),n=1;n<e.length;n++)e[n]=e[n].substr(0,1).toUpperCase()+e[n].substr(1);return e.join("")}function r(t,e){var r,s=t,o=e||["ms","O","Moz","Webkit","Khtml"],h=(t=a(s)).substr(0,1).toUpperCase()+t.substr(1),l=n.documentElement;if(l.style[t]!==i)return c[s]=s,t;r=(o.join(h+"/")+h).split("/");for(var u in r)if(l.style[r[u]]!==i)return c[s]="-"+o[u].toLowerCase()+"-"+s,r[u];return!1}var s={},o={},c={},h={rotate:"deg",rotateX:"deg",rotateY:"deg",skewX:"deg",skewY:"deg",perspective:"px",scale:"",translateX:"px",translateY:"px",translateZ:"px"};!function(){for(var t=arguments,e=0;e<t.length;e++)o[t[e]]=r(t[e])}("transform","perspective","transition","transform-origin"),s.transform=function(t,e){var n=e===i?t:function(n){return n[t]=e,n}({}),a=[];if(o.transform!==!1){for(var r in n)h[r]!==i&&(n[r]+"").search(h[r])<0&&(n[r]+=h[r]),a.push(r+"("+n[r]+")");this.style[o.transform]=a.join(" ")}},s.transition=function(t){this.style.setProperty===i?this.style[o.transition]=t:this.style.setProperty(c.transition,t)},s.transformOrigin=function(t){this.style.setProperty===i?this.style[o["transform-origin"]]=t:this.style.setProperty(c["transform-origin"],t)},s.perspective=function(t){o.perspective!==!1&&((t+"").search(h.perspective)<0&&(t+=h.perspective),this.style.setProperty===i?this.style[o.perspective]=t:this.style.setProperty(c.perspective,t))},s.animate=function(t,n,a){var r=this,n=n||400,o=[c.transform].join(",")+" "+n/1e3+"s "+"ease-in";s.transition.call(this,o),s.transform.call(this,t),e.setTimeout(function(){s.transition.call(r,"none"),a!==i&&a()},n)},t.fn.nchlightbox("access","css3",function(t){return new function(t){var e=this;this.el=t.jquery===i?t:(this.$el=t).get(0);for(var n in s)this[n]=function(t){return function(){s[t].apply(e.el,arguments)}}(n)}(t)})}(jQuery,window,document),function(t,e){function n(n,i,a){return function(r,s,o,c){if(c!==e)return 1==a?e:a*c;var h=i(s,Math.abs(s)),l=[h[0]];r.transformOrigin(h[2]||u),o&&l.push(n),h[0]!==e&&r[o?"animate":"transform"].apply({},l),h[1]!==e&&(l[0]=h[1],t.fn[o?"animate":"css"].apply(r.$el.stop(),l))}}var i="perspective",a="skewX",r="rotate",s="rotateX",o="rotateY",c="translateY",h="translateZ",l="opacity",u="50% 50%",d=400,p="scale";t.fn.nchlightbox("fx",{swipe:function(){},fade:n(d,function(t,n){var i={};return i[l]=1-n,[e,i]},1),scale:n(d,function(t,e){var n={};return n[p]=1-.6*e,[n]},1),slideUp:n(d,function(t){var e={};return e[c]=900*t,[e]},0),slideDown:n(d,function(t){var e={};return e[c]=-900*t,[e]},0),flip:n(d,function(t){var e={};return e[i]=1e3,e[o]=90*t,[e]},0),skew:n(d,function(t){var e={};return e[i]=1e3,e[a]=30*t,[e]},1),bounceDown:n(d,function(t,e){var n={};return n[i]=100,n[c]=1e3*e,[n]},1),bounceUp:n(d,function(t,e){var n={};return n[i]=100,n[c]=-1e3*e,[n]},1),hangLeft:n(d,function(t){var n={};return n[r]=-179*t,[n,e,"0% 0%"]},0),hangRight:n(d,function(t){var n={};return n[r]=-179*t,[n,e,"100% 0%"]},0),zoomIn:n(d,function(t,e){var n={},a={};return n[i]=800,n[h]=800*e,n[r]=45*t,a[l]=1-e,[n,a]},0),breakIn:n(d,function(t){var e={};return e[r]=45*t,[e]},1),rotateIn:n(d,function(t,e){var n={};return n[i]=1e3,n[o]=90*t,n[p]=1-.3*e,[n]},1),rotateOut:n(d,function(t,e){var n={};return n[i]=1e3,n[o]=-90*t,n[p]=1-.3*e,[n]},1),cicleDown:n(d,function(t,e){var n={},a={};return n[i]=1200,n[s]=-90*t,n[c]=200*e,a[l]=1-e,[n,a,"50% 100%"]},0),cicleUp:n(d,function(t,e){var n={},a={};return n[i]=1200,n[s]=-90*t,n[c]=-200*e,a[l]=1-e,[n,a,"50% 1%"]},0),throwIn:n(d,function(t,e){var n={},a={};return n[i]=800,n[p]=1-.6*e,n[r]=180*t,a[l]=1-e,[n,a]},.3),fall:n(d,function(t,e){var n={},a={};return n[i]=1800,n[s]=-90*e,n[r]=90*t,n[h]=-400*t,a[l]=Math.pow(1-e,.25),[n,a,u]},0),jump:n(d,function(t,e){var n={};return n[i]=1500,n[p]=1-.999*e,n[c]=300*e,n[s]=100*e,n[h]=1e3*e,[n]},0)})}(jQuery),function(t){function e(t,e){for(var n="",i=!1,a="",r=0;r<t.length;r++)i?"}"==t.charAt(r)?(e[a]&&(n+=e[a]),i=!1,a=""):a+=t.charAt(r):"{"==t.charAt(r)?i=!0:n+=t.charAt(r);
return n}function n(t){return"undefined"==typeof t.has.charAt?t.has():"undefined"!=typeof window[t.has]?!0:!1}function i(t){var e=document.createElement("script");e.async=!0,e.id=t.id,e.src=t.src,r.append(e)}function a(t,i,a){for(var r,i=i.split(","),o="",c=[],h=0;h<i.length;h++)(c[h]=n(r=s[i[h]]))&&(o+=e(r.create,a));t.append(o);for(var h in i)c[h]&&s[i[h]].parse(s[i[h]].api(),t.get(0))}var r,s={fb:{has:"FB",api:function(){return FB},parse:function(t,e){t.XFBML.parse(e)},id:"facebook-jssdk",src:"//connect.facebook.net/en_US/all.js",create:'<iframe class="fb-like" src="//www.facebook.com/plugins/like.php?layout=standard&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=20&amp;href={url}" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:20px;" allowTransparency="true"></iframe>'},tw:{has:"twttr",api:function(){return twttr},parse:function(t,e){t.widgets.load(e)},id:"twitter-wjs",src:"//platform.twitter.com/widgets.js",create:'<a href="https://twitter.com/share" class="twitter-share-button" data-url="{url}" data-text="{title}" data-count="none">Tweet</a>'},gp:{has:function(){return"undefined"==typeof gapi||"undefined"==typeof gapi.plusone?!1:!0},api:function(){return gapi.plusone},parse:function(t,e){t.go(e)},id:"",src:"//apis.google.com/js/plusone.js",create:'<div class="g-plusone" data-size="medium" data-annotation="none" data-href="{url}"></div>'},pin:{has:function(){for(var t in window)if(0==t.search("PIN_"))return!0;return!1},api:function(){for(var t in window)if(0==t.search("PIN_")&&window[t].f)return window[t]},parse:function(e,n){for(var i,a=t(n).is("a")?[n]:n.getElementsByTagName("a"),r=e.f.render,s=0;s<a.length;s++)"undefined"!=typeof(i=t(a[s]).attr("data-pin-do"))&&r[i](a[s])},id:"",src:"//assets.pinterest.com/js/pinit.js",create:'<a href="//pinterest.com/pin/create/button/?url={url}&media={media}&description={title}" data-pin-do="buttonPin" data-pin-config="none"><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png" /></a>'}};t(window).load(function(){var e;r=t("body");for(var o in s)e=s[o],n(e)||i(e);t.fn.nchlightbox("access","shareButtons",a)})}(jQuery),function(t,e,n){var i={grid:function(e,n){this.name="",this.set=e,this.opts=t.extend({},t.fn.nchgrid.defaults,n),this.images=[],this.items=[],this.cols=[],this.width=0,this.columns=0,this.filters=[],n.target||(this.opts.target=t(e.parent()))},column:function(){this.images=[],this.height=0,this.width=0,this.aspect=0,this.less=!1,this.addImage=function(t){this.images.push(t),this.aspect+=t.aspect}},getColumns:function(t,e){for(var n=0;e[n]<t;)n++;return n==e.length?n:n+1},resolveDeltaHeight:function(t,e,n,i){return(t+e*i)/(n+i)},spreadImages:function(t,e){var i=t.images,a=i.length;if(t.opts.order)for(var r=0;a>r;r++)e[r%t.columns].addImage(i[r]);else{for(var s,o=i.length,c=0,h=t.columns,l=[],r=0;h>r;r++)l.push({index:l.length,aspect:0});for(;o>c;){s=[];for(var r=0;h>r;r++)i[c+r]!=n&&s.push({aspect:1/i[c+r].aspect,index:c+r});s.sort(function(t,e){return t.aspect>e.aspect}),l.sort(function(t,e){return t.aspect<e.aspect});for(var r=0;r<s.length;r++)e[l[r].index].addImage(i[s[r].index]),l[r].aspect+=s[r].aspect;c+=h}}},renderGrid:function(e){var n=function(){i.updateGrid(e)};t(window).resize(n),n()},updateGrid:function(e){var n=e.opts,a=(e.set,e.images),r=n.target,s=e.cols,o=n.target.width();if(e.width!=o){if(e.columns=i.getColumns(e.width=o,n.grid),e.columns!=s.length){s=[];for(var c=0;c<e.columns;c++)s[c]=new i.column;i.spreadImages(e,s)}for(var h=e.width-(s.length-1)*n.margin,l=Math.floor(a.length/e.columns),u=0,d=0,c=0;c<e.columns;c++)(s[c].less=s[c].images.length==l)?u+=1/s[c].aspect:d+=1/s[c].aspect;for(var p,f,g,m=i.resolveDeltaHeight(h,n.margin,u,d),v=0,b=0,c=0;c<s.length;c++){f=s[c],all=f.images,p=1/f.aspect*(m-(f.less?0:n.margin)),b=0;for(var w=0;w<all.length;w++)g=t(e.items[all[w].index]).css({position:"absolute",left:v,top:b,width:p,height:p*all[w].aspect,display:"block"}).addClass("nchgrid-tile"),b+=p*all[w].aspect+n.margin;v+=p+n.margin}r.height(b-n.margin),"static"==r.css("position")&&r.css("position","relative")}},triggerClick:function(e){e.preventDefault(),t(e.target).is("img")||t(this).find("img").click()},loadTiles:function(){function e(e,r,s){var o,c;n.images[e]={width:r,height:s,aspect:s/r,src:n.set[e].src,index:e,caption:c=n.set[e].title},n.items[e]=(o=t('<div class="nchgrid-item"></div>').insertAfter(n.set[e]).append(n.set[e])).get(0),n.opts.captions&&(c+"").length?o.append('<div class="nchgrid-caption"></div><div class="nchgrid-caption-text">'+c+"</div>").click(i.triggerClick):o.append('<div class="nchgrid-caption"></div>').click(i.triggerClick),a++==n.set.length-1&&i.renderGrid(n)}var n=this,a=0;this.set.each(function(t,n){var i=new Image;i.onload=function(){e(t,this.width,this.height),n.style.display="block"},i.src=this.src,n.style.display="none"})}},a={init:function(e){var n=this;if(!this.length){var a,r=arguments,s=e,o=[];e=t.extend({},t.fn.nchgrid.defaults,2==r.length?r[1]:{});for(var c=0;c<s.length;c++)a=new Image,a.src=s[c],o.push(a);n=this.add(o).appendTo(e.target)}return i.loadTiles.call(new i.grid(n,t.extend({},t.fn.nchgrid.defaults,e||{}))),n}};t.fn.nchgrid=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):a.init.apply(this,arguments)},t.fn.nchgrid.defaults={margin:4,grid:[240,480,720,960,1240],captions:!1,order:!1,target:!1}}(jQuery,window),function(t,e,n,i){function a(t){2==(t.gesture.srcEvent.type+"").split("touch").length&&(c=!0),h.off("touch",a)}function r(e,n,a){function r(){b.cwidth=b.container.width(),b.cheight=b.container.height()}function s(t){return t=t===i?1:t,{e:[t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1]}}function h(t){return t.e.join(", ")}function l(t){var e=b.width*t-b.cwidth,n=b.height*t-b.cheight;T=-Math.abs(0>e?0:e),M=-Math.abs(0>n?0:n)}var u,d,p,f=1,g=0,m=0,v=!1,b=this;this._el=o(e),this.$el=e.css({display:"block"}),this.container=p=t("<div></div>").insertAfter(e).append(e),this._container=p.hammer({prevent_default:!0}),this.width=e.get(0).width||e.width(),this.height=e.get(0).height||e.height(),this.scale=1,this.centerX=.5,this.centerY=.5,this.translateX=0,this.translateY=0,this.transform=b.transform=s(),this._el.transformOrigin("0 0"),this.container.css({width:n||this.width,height:a||this.height,overflow:c?"hidden":"auto"});var w,y,x,k,j,Q,C,z,g=0,m=0,I=0,T=0,M=0,_=0,S=0,F=0,E=!1,L=!1;r(),this.transformStart=function(t){L&&(L=!1,b.dragEnd(t)),r(),E=!0,w=t.gesture.center.pageX,y=t.gesture.center.pageY,x=p.scrollLeft(),k=p.scrollTop(),j=p.offset(),Q=j.left,C=j.top,b.centerX=u=(w-Q-g-S)/b.width/b.scale,u=0>u?0:u>1?1:u,b.centerY=d=(y-C-m-F)/b.height/b.scale,d=0>d?0:d>1?1:d},this.drag=function(t){if(!E){v=t.gesture,S=v.deltaX+g+I,F=v.deltaY+m+_,l(f);var e=s(f);e.e[12]=S=0>S?S>T?S:T:0,e.e[13]=F=0>F?F>M?F:M:0,b._el.transform("matrix3d",h(z=e))}},this.pinch=function(t){E=!0,v=t.gesture,f=b.scale*v.scale,1>f&&(f=1),f>4&&(f=4),l(f),I=(b.scale-f)*b.width*b.centerX+g+S,_=(b.scale-f)*b.height*b.centerY+m+S;var e=s(f);e.e[12]=I=0>I?I>T?I:T:0,e.e[13]=_=0>_?_>M?_:M:0,b._el.transform("matrix3d",h(z=e))},this.transformEnd=function(){b.scale=f,b.transform=z,E=!0,g=I,m=_,S=F=I=_=0},this.dragEnd=function(){return L=!1,E?(E=!1,void 0):(b.transform=z,g=S,m=F,I=_=S=F=0,void 0)},this.dragStart=function(){r(),E||(E=!1,L=!0)},c&&this._container.on("transformstart",this.transformStart).on("transform",this.pinch).on("transformend",this.transformEnd).on("dragstart",this.dragStart).on("drag",this.drag).on("dragend",this.dragEnd)}var s=t.fn.nchlightbox("access"),o=s.css3,c=!1,h=t(e).hammer();h.on("touch",a),t.fn.nchlightbox("access","pinch",function(e,n){var a;return t(this).each(function(s,o){var c;o=t(o),o.data("nch-pinchzoom",c=new r(o,e,n)),a===i?a=t(c.container):a.add(c.container)}),a})}(jQuery,window,document);